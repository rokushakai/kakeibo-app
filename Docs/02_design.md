# 家計簿アプリ 設計書

## 1. 技術スタック
- **バックエンド**: Flask (Python)
- **データベース**: SQLite
- **フロントエンド**: HTML, CSS, JavaScript

## 2. データベース設計

### `expenses` テーブル
| フィールド名 | データ型 | 説明 |
| :--- | :--- | :--- |
| `id` | INTEGER | 主キー（自動採番） |
| `date` | TEXT | 支出日 (形式: 'YYYY-MM-DD') |
| `amount` | INTEGER | 金額（円） |
| `item_name`| TEXT | 品物名 |
| `category` | TEXT | 勘定科目 |
| `sub_category`| TEXT | 事業主費の内訳。それ以外はNULL。 |

## 3. 画面設計
- **トップページ (`/`)**:
  - 支出の新規登録フォームと、全支出履歴一覧を表示する。
  - 日付入力は年/月/日のプルダウン形式とし、最後に選択した日付を記憶する。
  - 勘定科目と事業主費のプルダウンは連動する。
  - 支出一覧は日付での昇順/降順ソートが可能。
- **集計・検索ページ (`/search`)**:
  - 期間、金額範囲、フリーワード、勘定科目（チェックボックス）、事業主費の内訳（チェックボックス）の検索条件を入力するフォームを配置する。
  - 検索結果をテーブル形式で表示する。
  - 検索結果をCSVファイルとしてエクスポートするボタンを配置する。

## 4. URL設計（ルーティング）
| URL | HTTPメソッド | 機能 |
| :--- | :--- | :--- |
| `/` | GET | トップページ（一覧・登録フォーム）表示 |
| `/add` | POST | 新規支出を登録 |
| `/search` | GET | 検索ページ表示と検索結果の処理 |
| `/export_csv` | GET | 検索条件に基づいたCSVをダウンロード |